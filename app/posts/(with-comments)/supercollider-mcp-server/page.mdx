---
title: SuperColliderを操作するMCPサーバーを作ってみた
date: 2025/04/16
tags: [tech, SuperCollider, MCP, 音楽, プログラミング]
description: Model Context Protocol (MCP) を使ってSuperColliderを対話的に操作できるサーバーを開発しました。
author: makotyo
---

## はじめに


SuperColliderは、プログラミングで音響合成が行える強力なシンセサイザーですが、使いこなすにはSuperColliderの文法の理解と音響合成の知識が必要です。
そこで、最近注目を集めているModel Context Protocol (MCP) を使って、手軽に自然言語でスパコを操ることができるのでは？と考え、SuperColliderを操作するMCPサーバーを開発しました。

import { Cards } from 'nextra/components'
import { FaGithub } from "react-icons/fa";


開発したMCPサーバーのリポジトリは以下のリンクからアクセスできるので、興味のある方はぜひのぞいてみてください。

<Cards>
  <Cards.Card
    icon={<FaGithub />}
    title="GitHub supercollider-mcp"
    href="https://github.com/Synohara/supercollider-mcp"
    target="_blank"
  />
</Cards>

この記事ではインストールのやり方や使い方を解説していこうと思います。


### 視覚的なデモ
[デモ動画をここに追加予定]

動画では以下の機能をご紹介する予定です：
1. シンプルなシンセサイザーの作成と制御
2. エフェクトの適用とパラメータ調整
3. リアルタイムでの音楽生成

### 音声サンプル
[音声サンプルをここに追加予定]

以下のような音声サンプルを追加予定です：
1. 基本的なシンセサイザーサウンド
2. エフェクト処理後の音声
3. 自動生成された音楽パターン

## できること

2つのToolを提供しています。

**synth-execute**

1つのシンセサイザーを作成し、そのコードで音を出します。
引数はシンセサイザー名、シンセサイザーのコードを含むオブジェクトと再生時間です。

スキーマだけ抜粋すると以下のようになります。

```typescript
{
    synth: z.object({
      name: z.string().describe("シンセの名前"),
      code: z.string().describe("シンセのコード")
    }).describe("再生するシンセの情報"),
    duration: z.number().optional().describe("再生時間（ミリ秒）。デフォルトは5000（5秒）")
}
```

**multi-synth-execute**

複数のシンセサイザーを作成し、それらを同時に演奏します。
引数はシンセサイザーのオブジェクトのリストと再生時間です。

こちらのスキーマは以下のようになります。

```typescript
{
  synths: z.array(
    z.object({
      name: z.string().describe("シンセの名前"),
      code: z.string().describe("シンセのコード")
    })
  ).describe("再生するシンセのリスト"),
  duration: z.number().optional().describe("再生時間（ミリ秒）。デフォルトは10000（10秒）")
}
```



## インストール方法

### 前提条件

M1 Macで以下のソフトウェアを利用して動作確認を行いました。

- SuperCollider 3.13.0
- Node.js v22.2.0
- npm 10.7.0


### セットアップ

#### SuperColliderのインストール

- [SuperColliderの公式サイト](https://supercollider.github.io/download)からインストーラーをダウンロードしてインストールします。

#### Node.jsのインストール

- [Node.jsの公式サイト](https://nodejs.org/ja/download)を参照してインストールします。

#### MCPクライアントの設定

Claude DesktopやVS CodeなどMCPサーバーが利用可能なクライアントへ以下の設定を追加します。


- Claude Desktopの場合

`/Users/<ユーザー名>/Library/Application\ Support/Claude/claude_desktop_config.json` に以下の設定を追加します。

```json
{
  "mcpServers": {
    "supercollider-mcp": {
      "command": "npx",
      "args": [
        "-y",
        "@makotyo/supercollider-mcp",
      ]
    }
  }
}
```

- VS Codeの場合

VS Codeのユーザー設定（json）ファイルに以下のjsonブロックを追加してください。
設定を開くには、`Ctrl + Shift + P`を押して「Preferences: Open User Settings (JSON)」と入力します。

```json
{
  "mcp": {
    "servers": {
      "mcp-supercollider": {
        "command": "npx",
        "args": [
          "-y",
          "@makotyo/mcp-supercollider"
        ]
      }
    }
  }
}
```

## 使用例

以下のような操作が自然言語で可能になります：

import { ChatBubble } from '../../../components/ChatBubble'

1. サイン波の生成

<ChatBubble 
  content="サイン波を出してください"
  isUser={true}
/>

2. エフェクトの適用

<ChatBubble 
  content="現在の音にリバーブを追加して、ディレイタイムを2秒に設定してください"
  isUser={true}
/>


3. パターンの生成

<ChatBubble 
  content="BPM120でシンプルなドラムパターンを生成してください"
  isUser={true}
/>


## 開発中の課題と解決策

開発中に遭遇したいくつかの課題とその解決策について説明します。

### プロセス管理の問題

#### 課題
SuperColliderのサーバープロセス（scsynth）が適切に終了せず、バックグラウンドで動き続けてしまう問題が発生しました。

#### 解決策

Tool実行時にdurationのパラメータを組み込むことで、指定した時間が経過した後にサーバーを終了させることでサーバーのプロセスが残り続けることを防ぎつつ、音を望む時間だけ出力するようにしました。


## まとめ

MCPサーバーを活用することで、SuperColliderをより直感的に操作できるようになりました。

音楽制作の新しい可能性を広げるツールとして、ぜひ試してみてください。
フィードバックやコントリビューションもお待ちしています！
